<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>员工每日工作量统计系统</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
</head>
<body>
    <div class="container">
        <!-- 标题栏 -->
        <header class="header">
            <h1>工作量统计系统</h1>
        </header>

        <!-- 主要内容区域（两列布局） -->
        <div class="main-content">
            <!-- 左侧：文件上传 + 报表信息 -->
            <div class="left-column">
                <!-- 文件上传区域 -->
                <section class="upload-section">
                    <div class="card compact">
                        <h2>上传文件</h2>
                        <div class="upload-group-compact">
                            <div class="upload-item-compact">
                                <label for="pickingFile">
                                    <span class="label-text">Picking</span>
                                    <input type="file" id="pickingFile" accept=".xlsx,.xls" />
                                    <span class="file-name" id="pickingFileName">选择文件</span>
                                </label>
                            </div>
                            <div class="upload-item-compact">
                                <label for="packingFile">
                                    <span class="label-text">Packing</span>
                                    <input type="file" id="packingFile" accept=".xlsx,.xls" />
                                    <span class="file-name" id="packingFileName">选择文件</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 报表信息 -->
                <section class="info-section">
                    <div class="card compact">
                        <h2>报表信息</h2>
                        <div class="form-row">
                            <div class="form-group-inline">
                                <label for="dateInput">日期:</label>
                                <input type="date" id="dateInput" />
                            </div>
                            <div class="form-group-inline">
                                <label for="timeInput">时间:</label>
                                <input type="text" id="timeInput" value="8.00-15.30" placeholder="8.00-15.30" />
                            </div>
                        </div>
                        <div class="form-group-inline">
                            <label for="preshipmentCount">Preshipment:</label>
                            <input type="number" id="preshipmentCount" value="1" min="0" max="10" onchange="updatePreshipmentInputs()" />
                            <button class="btn-secondary small" onclick="updatePreshipmentInputs()">更新</button>
                            <button class="btn-secondary small" onclick="openEmployeeManager()">编辑</button>
                        </div>
                        <div id="preshipmentContainer" class="preshipment-container compact">
                            <!-- 动态生成 Preshipment 输入框 -->
                        </div>
                    </div>
                </section>
            </div>

            <!-- 右侧：日志 + 按钮 -->
            <div class="right-column">
                <section class="log-section">
                    <div class="card compact">
                        <h2>处理日志</h2>
                        <div class="log-container" id="logContainer">
                            <div class="log-line">欢迎使用工作量统计系统</div>
                            <div class="log-line">请上传文件并填写报表信息</div>
                        </div>
                    </div>
                </section>
                
                <!-- 生成按钮 -->
                <section class="action-section">
                    <button class="btn-primary" id="generateBtn" onclick="openFunctionModal()">
                        运行
                    </button>
                </section>
            </div>
        </div>
    </div>

    <!-- 功能选择弹窗 -->
    <div id="functionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>选择报表类型</h2>
                <span class="close" onclick="closeFunctionModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="function-list">
                    <div class="function-item">
                        <label class="function-checkbox">
                            <input type="checkbox" id="dailyReport" value="daily" checked>
                            <span class="checkmark"></span>
                            <div class="function-info">
                                <h3>每日工作报表</h3>
                                <p>生成包含所有员工工作量的详细报表</p>
                            </div>
                        </label>
                    </div>
                    <div class="function-item">
                        <label class="function-checkbox">
                            <input type="checkbox" id="efficiencyReport" value="efficiency">
                            <span class="checkmark"></span>
                            <div class="function-info">
                                <h3>人效表</h3>
                                <p>生成上午时段(00:00-12:00)的人效分析报表</p>
                            </div>
                        </label>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn-secondary" onclick="closeFunctionModal()">取消</button>
                    <button class="btn-primary" onclick="executeSelectedFunctions()">运行</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 员工管理弹窗 -->
    <div id="employeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>员工管理</h2>
                <span class="close" onclick="closeEmployeeManager()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="employee-add-section">
                    <input type="text" id="newEmployeeName" placeholder="输入员工姓名" />
                    <button class="btn-primary" onclick="addEmployee()">添加</button>
                </div>
                <div class="employee-list" id="employeeList">
                    <!-- 员工列表将动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>

